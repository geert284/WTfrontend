<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="mystyle.css">
    
</head>
<body>
    <img src="WT-logo.png" width="216" height="56">
    <button type="button" class="button-solid" onclick="window.location.href = 'home-page.html';">Home</button>
    <button type="button" class="button-solid" onclick="window.location.href = 'library.html';">Bibliotheek</button>
    <button type="button" class="button-solid" onclick="window.location.href = 'my-books.html';">Mijn boeken</button>
    <button type="button" class="button-solid" onclick="window.location.href = 'res-and-loans.html';">Reserveringen en Leningen</button>
    <button type="button" class="button-solid" onclick="window.location.href = 'manage-books.html';">Boeken beheren</button>
    <button type="button" class="button-solid" onclick="window.location.href = 'manage-users.html';">Gebruikers beheren</button>
    
    <img src="account-logo.png" style="float:right; margin-right:20px; margin-top:40px;" width="20" height="20">
    <button type="button" style="float:right; margin-right:10px; margin-top:43px;" class="button-solid" onclick="window.location.href = 'my-account.html';">Mijn account</button>
    <h2>Bibliotheek</h2>

    <input type="text" id="searchBar">
    <button type="button" onclick="createPerson()">Zoek een boek</button>


    <h1>Boekenlijst</h1>
    <table id="booksTable"></table>

    <script>       

        let searchTerm = document.getElementById('searchBar');
        let booksTable = document.getElementById('booksTable');

        // functie die JSON gegevens bijwerkt op basis van zoekbalk
        function updateTable(searchTerm) {

            fetch('http://localhost:8080/book/all')
                // zodra antwoord: zet json om naar object, anonymous function
                .then(response => response.json()) // soort if statement, mag ook direct achter de fetch
                .then(data => {
                    // filter
                    const filteredBooks = searchTerm ? data.filter(book => {
                        return book.title.toLowerCase().includes(searchTerm.toLowerCase()) ||
                               book.author.toLowerCase().includes(searchTerm.toLowerCase()) ||
                               book.isbn.toLowerCase().includes(searchTerm.toLowerCase()) ||
                               book.collation.toLowerCase().includes(searchTerm.toLowerCase()) ||
                               book.category.toLowerCase().includes(searchTerm.toLowerCase()) ||
                               book.edition.toLowerCase().includes(searchTerm.toLowerCase()) ||
                               book.language.toLowerCase().includes(searchTerm.toLowerCase());
                    }) : data;

                    // Bouw de tabel
                    const tableHTML = filteredBooks.map(book => {
                        return `<tr>
                                <td>${book.title}</td>
                                <td>${book.author}</td>
                                <td>${book.isbn}</td>
                                <td>${book.collation}</td>   
                                <td>${book.category}</td>
                                <td>${book.edition}</td> 
                                <td>${book.language}</td>
                            <tr>`;
                    }).join('');

                    // Voeg bovenste regel van de tabel toe
                    booksTable.innerHTML = `<tr>
                                            <th>Title</th>
                                            <th>Author</th>
                                            <th>Isbn</th>
                                            <th>Collation</th>
                                            <th>Category</th>
                                            <th>Edition</th>
                                            <th>language</th>
                                        </tr>${tableHTML}`;
                });
        };
        searchTerm.addEventListener('input', function() {
            updateTable(searchTerm.value);
        });
        updateTable('');

    </script>


</body>

</html>